function drawField() {
    const formation = document.getElementById('formation').value;
    const field = document.getElementById('field');
    field.innerHTML = ''; // reset terrain

    const layout = formations[formation];

    // Inverser pour que ST en haut, GK en bas
    const reversedLayout = layout.slice().reverse();

    reversedLayout.forEach((line, i) => {
        const row = document.createElement('div');
        row.style.display = 'flex';
        row.style.justifyContent = 'space-between';
        row.style.margin = '20px 0';
        row.style.position = 'relative';

        // Pour la ligne du gardien
        if (line.includes('GK')) {
            row.style.justifyContent = 'center';
        }

        // Pour chaque position dans la ligne
        line.forEach((pos, index) => {
            const card = document.createElement('div');
            card.className = 'player-card';

            const player = squad[pos] || null;
            if (player) {
                card.className = 'player-card filled';
                card.innerHTML = `<div class="player-position">${pos}</div>
                                  <div class="player-flag">${player.flag}</div>
                                  <div class="player-name">${player.name}</div>
                                  <div class="player-club">${player.club || ''}</div>`;
            } else {
                card.className = 'player-card empty';
                card.innerHTML = `<div class="player-position">${pos}</div>
                                  <div class="empty-text">Vide</div>`;
            }

            card.onclick = () => openPlayerModal(pos);

            // Ajustement horizontal selon rôle
            if(['LW','RW'].includes(pos)) {
                card.style.flex = '1';
                card.style.margin = '0 40px'; // large sur les côtés
            } else if(pos === 'ST' || pos === 'CF') {
                card.style.flex = '1';
                card.style.margin = '0 10px';
            } else if(pos.includes('CM') || pos.includes('CAM') || pos.includes('CDM')) {
                card.style.flex = '1';
                card.style.margin = '0 20px';
            } else if(pos.includes('CB') || pos.includes('LB') || pos.includes('RB')) {
                card.style.flex = '1';
                card.style.margin = '0 15px';
            } else if(pos === 'GK') {
                card.style.flex = '0';
                card.style.margin = '0';
            }

            row.appendChild(card);
        });

        field.appendChild(row);
    });

    // Coach et GOAT
    if (squad.coach) {
        const coachDiv = document.createElement('div');
        coachDiv.className = 'coach-display';
        coachDiv.innerHTML = `<div class="role-label">Coach</div><span>${squad.coach.name}</span>`;
        field.appendChild(coachDiv);
    }
    if (squad.goat) {
        const goatDiv = document.createElement('div');
        goatDiv.className = 'goat-display';
        goatDiv.innerHTML = `<div class="role-label">GOAT</div><span>${squad.goat.name}</span>`;
        field.appendChild(goatDiv);
    }
}
